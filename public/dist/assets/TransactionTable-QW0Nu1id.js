import{w as ae,x as se,r as V,E as K,j as S,B as U,S as oe,I as ee}from"./index-C-veA1Rv.js";import{u as X}from"./useApi-hqwvaQFr.js";import{D as ie,b as ce}from"./DataGridFooter-CqbU6PzW.js";import{e as Z,f as ue,g as le,h as de,i as fe}from"./index-B9-GP8Fy.js";import{u as he}from"./useTheme-CSbpYfTu.js";import{T as pe}from"./Tooltip-BeN_8m-j.js";var te={exports:{}};(function(i,l){(function(d,D){i.exports=D()})(ae,function(){var d=1e3,D=6e4,x=36e5,L="millisecond",T="second",M="minute",C="hour",c="day",w="week",$="month",A="quarter",v="year",O="date",F="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,N=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,re={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(a){var r=["th","st","nd","rd"],e=a%100;return"["+a+(r[(e-20)%10]||r[e]||r[0])+"]"}},z=function(a,r,e){var n=String(a);return!n||n.length>=r?a:""+Array(r+1-n.length).join(e)+a},ne={s:z,z:function(a){var r=-a.utcOffset(),e=Math.abs(r),n=Math.floor(e/60),t=e%60;return(r<=0?"+":"-")+z(n,2,"0")+":"+z(t,2,"0")},m:function a(r,e){if(r.date()<e.date())return-a(e,r);var n=12*(e.year()-r.year())+(e.month()-r.month()),t=r.clone().add(n,$),s=e-t<0,o=r.clone().add(n+(s?-1:1),$);return+(-(n+(e-t)/(s?t-o:o-t))||0)},a:function(a){return a<0?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:$,y:v,w,d:c,D:O,h:C,m:M,s:T,ms:L,Q:A}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return a===void 0}},W="en",b={};b[W]=re;var q="$isDayjsObject",J=function(a){return a instanceof B||!(!a||!a[q])},P=function a(r,e,n){var t;if(!r)return W;if(typeof r=="string"){var s=r.toLowerCase();b[s]&&(t=s),e&&(b[s]=e,t=s);var o=r.split("-");if(!t&&o.length>1)return a(o[0])}else{var f=r.name;b[f]=r,t=f}return!n&&t&&(W=t),t||!n&&W},m=function(a,r){if(J(a))return a.clone();var e=typeof r=="object"?r:{};return e.date=a,e.args=arguments,new B(e)},u=ne;u.l=P,u.i=J,u.w=function(a,r){return m(a,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var B=function(){function a(e){this.$L=P(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[q]=!0}var r=a.prototype;return r.parse=function(e){this.$d=function(n){var t=n.date,s=n.utc;if(t===null)return new Date(NaN);if(u.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var o=t.match(h);if(o){var f=o[2]-1||0,p=(o[7]||"0").substring(0,3);return s?new Date(Date.UTC(o[1],f,o[3]||1,o[4]||0,o[5]||0,o[6]||0,p)):new Date(o[1],f,o[3]||1,o[4]||0,o[5]||0,o[6]||0,p)}}return new Date(t)}(e),this.init()},r.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},r.$utils=function(){return u},r.isValid=function(){return this.$d.toString()!==F},r.isSame=function(e,n){var t=m(e);return this.startOf(n)<=t&&t<=this.endOf(n)},r.isAfter=function(e,n){return m(e)<this.startOf(n)},r.isBefore=function(e,n){return this.endOf(n)<m(e)},r.$g=function(e,n,t){return u.u(e)?this[n]:this.set(t,e)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(e,n){var t=this,s=!!u.u(n)||n,o=u.p(e),f=function(H,_){var I=u.w(t.$u?Date.UTC(t.$y,_,H):new Date(t.$y,_,H),t);return s?I:I.endOf(c)},p=function(H,_){return u.w(t.toDate()[H].apply(t.toDate("s"),(s?[0,0,0,0]:[23,59,59,999]).slice(_)),t)},y=this.$W,g=this.$M,E=this.$D,R="set"+(this.$u?"UTC":"");switch(o){case v:return s?f(1,0):f(31,11);case $:return s?f(1,g):f(0,g+1);case w:var k=this.$locale().weekStart||0,j=(y<k?y+7:y)-k;return f(s?E-j:E+(6-j),g);case c:case O:return p(R+"Hours",0);case C:return p(R+"Minutes",1);case M:return p(R+"Seconds",2);case T:return p(R+"Milliseconds",3);default:return this.clone()}},r.endOf=function(e){return this.startOf(e,!1)},r.$set=function(e,n){var t,s=u.p(e),o="set"+(this.$u?"UTC":""),f=(t={},t[c]=o+"Date",t[O]=o+"Date",t[$]=o+"Month",t[v]=o+"FullYear",t[C]=o+"Hours",t[M]=o+"Minutes",t[T]=o+"Seconds",t[L]=o+"Milliseconds",t)[s],p=s===c?this.$D+(n-this.$W):n;if(s===$||s===v){var y=this.clone().set(O,1);y.$d[f](p),y.init(),this.$d=y.set(O,Math.min(this.$D,y.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},r.set=function(e,n){return this.clone().$set(e,n)},r.get=function(e){return this[u.p(e)]()},r.add=function(e,n){var t,s=this;e=Number(e);var o=u.p(n),f=function(g){var E=m(s);return u.w(E.date(E.date()+Math.round(g*e)),s)};if(o===$)return this.set($,this.$M+e);if(o===v)return this.set(v,this.$y+e);if(o===c)return f(1);if(o===w)return f(7);var p=(t={},t[M]=D,t[C]=x,t[T]=d,t)[o]||1,y=this.$d.getTime()+e*p;return u.w(y,this)},r.subtract=function(e,n){return this.add(-1*e,n)},r.format=function(e){var n=this,t=this.$locale();if(!this.isValid())return t.invalidDate||F;var s=e||"YYYY-MM-DDTHH:mm:ssZ",o=u.z(this),f=this.$H,p=this.$m,y=this.$M,g=t.weekdays,E=t.months,R=t.meridiem,k=function(_,I,Y,G){return _&&(_[I]||_(n,s))||Y[I].slice(0,G)},j=function(_){return u.s(f%12||12,_,"0")},H=R||function(_,I,Y){var G=_<12?"AM":"PM";return Y?G.toLowerCase():G};return s.replace(N,function(_,I){return I||function(Y){switch(Y){case"YY":return String(n.$y).slice(-2);case"YYYY":return u.s(n.$y,4,"0");case"M":return y+1;case"MM":return u.s(y+1,2,"0");case"MMM":return k(t.monthsShort,y,E,3);case"MMMM":return k(E,y);case"D":return n.$D;case"DD":return u.s(n.$D,2,"0");case"d":return String(n.$W);case"dd":return k(t.weekdaysMin,n.$W,g,2);case"ddd":return k(t.weekdaysShort,n.$W,g,3);case"dddd":return g[n.$W];case"H":return String(f);case"HH":return u.s(f,2,"0");case"h":return j(1);case"hh":return j(2);case"a":return H(f,p,!0);case"A":return H(f,p,!1);case"m":return String(p);case"mm":return u.s(p,2,"0");case"s":return String(n.$s);case"ss":return u.s(n.$s,2,"0");case"SSS":return u.s(n.$ms,3,"0");case"Z":return o}return null}(_)||o.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(e,n,t){var s,o=this,f=u.p(n),p=m(e),y=(p.utcOffset()-this.utcOffset())*D,g=this-p,E=function(){return u.m(o,p)};switch(f){case v:s=E()/12;break;case $:s=E();break;case A:s=E()/3;break;case w:s=(g-y)/6048e5;break;case c:s=(g-y)/864e5;break;case C:s=g/x;break;case M:s=g/D;break;case T:s=g/d;break;default:s=g}return t?s:u.a(s)},r.daysInMonth=function(){return this.endOf($).$D},r.$locale=function(){return b[this.$L]},r.locale=function(e,n){if(!e)return this.$L;var t=this.clone(),s=P(e,n,!0);return s&&(t.$L=s),t},r.clone=function(){return u.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},a}(),Q=B.prototype;return m.prototype=Q,[["$ms",L],["$s",T],["$m",M],["$H",C],["$W",c],["$M",$],["$y",v],["$D",O]].forEach(function(a){Q[a[1]]=function(r){return this.$g(r,a[0],a[1])}}),m.extend=function(a,r){return a.$i||(a(r,B,m),a.$i=!0),m},m.locale=P,m.isDayjs=J,m.unix=function(a){return m(1e3*a)},m.en=b[W],m.Ls=b,m.p={},m})})(te);var me=te.exports;const ye=se(me),Te=(i,l)=>{switch(l.type){case"SET_TOTAL_INVESTMENT":return{...i,totalInvestment:l.payload};case"SET_TRANSACTIONS":return{...i,transactions:l.payload};case"SET_SPENT_THIS_MONTH":return{...i,spentThisMonth:l.payload};case"SET_ROI":return{...i,ROI:l.payload};case"SET_ACCOUNT_BALANCE":return{...i,accountBalance:l.payload};case"SET_INVESTED_COMPANIES":return{...i,investedCompanies:l.payload};case"SET_PENDING_TRANSACTIONS":return{...i,pendingTransactions:l.payload};case"SET_WITHDRAWALS":return{...i,withdrawals:l.payload};case"SET_TOTAL_WITHDRAWN_THIS_MONTH":return{...i,totalWithdrawnThisMonth:l.payload};case"SET_LOADING":return{...i,loading:l.payload};case"SET_ERROR":return{...i,error:l.payload};case"RESET":return{totalInvestment:0,transactions:[],spentThisMonth:0,ROI:0,accountBalance:0,investedCompanies:[],pendingTransactions:[],withdrawals:[],totalWithdrawnThisMonth:0,loading:!1,error:null};default:return i}},we=i=>{const[l,d]=V.useReducer(Te,{totalInvestment:0,transactions:[],spentThisMonth:0,ROI:0,accountBalance:0,investedCompanies:[],pendingTransactions:[],withdrawals:[],totalWithdrawnThisMonth:0,loading:!1,error:null}),{callApi:D}=X(),{callApi:x}=X();return V.useEffect(()=>{if(!i||!i._id){d({type:"RESET"});return}d({type:"SET_LOADING",payload:!0}),d({type:"SET_TOTAL_INVESTMENT",payload:i.totalInvestment??0}),d({type:"SET_ROI",payload:i.totalROI??0}),d({type:"SET_ACCOUNT_BALANCE",payload:i.accountBalance??0}),(async()=>{try{const[T,M]=await Promise.all([D({url:`${K.TRANSACTIONS}/user/${i._id}`,method:"GET",headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}}),x({url:`${K.WITHDRAWALS}/user/${i._id}`,method:"GET",headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}})]),c=(Array.isArray(T==null?void 0:T.transactions)?T.transactions:[]).map(h=>({...h,createdAt:h.createdAt?new Date(h.createdAt):new Date,updatedAt:h.updatedAt?new Date(h.updatedAt):new Date}));d({type:"SET_TRANSACTIONS",payload:c});const w=c.filter(h=>h.status==="pending");d({type:"SET_PENDING_TRANSACTIONS",payload:w});const $=c.reduce((h,N)=>N.status==="completed"&&N.createdAt&&N.createdAt.getFullYear()===new Date().getFullYear()&&N.createdAt.getMonth()===new Date().getMonth()?h+N.amount:h,0);d({type:"SET_SPENT_THIS_MONTH",payload:$});const A=[...new Set(c.filter(h=>h.status==="completed").map(h=>h.companyName))];d({type:"SET_INVESTED_COMPANIES",payload:A});const O=(Array.isArray(M==null?void 0:M.withdrawals)?M.withdrawals:[]).map(h=>({...h,createdAt:h.createdAt?new Date(h.createdAt):new Date,updatedAt:h.updatedAt?new Date(h.updatedAt):new Date}));d({type:"SET_WITHDRAWALS",payload:O});const F=O.reduce((h,N)=>N.status==="successful"&&N.createdAt&&N.createdAt.getFullYear()===new Date().getFullYear()&&N.createdAt.getMonth()===new Date().getMonth()?h+N.amount:h,0);d({type:"SET_TOTAL_WITHDRAWN_THIS_MONTH",payload:F})}catch(T){console.error("Failed to fetch data:",T),d({type:"SET_TRANSACTIONS",payload:[]}),d({type:"SET_SPENT_THIS_MONTH",payload:0}),d({type:"SET_PENDING_TRANSACTIONS",payload:[]}),d({type:"SET_INVESTED_COMPANIES",payload:[]}),d({type:"SET_WITHDRAWALS",payload:[]}),d({type:"SET_TOTAL_WITHDRAWN_THIS_MONTH",payload:0}),d({type:"SET_ERROR",payload:T instanceof Error?T:new Error("Unknown error")})}finally{d({type:"SET_LOADING",payload:!1})}})()},[i,D,x]),l},Se=(i,l)=>{switch(i==null?void 0:i.toLowerCase()){case"usd":return S.jsx(Z,{style:{fontSize:l,color:"#85bb65"}});case"cad":return S.jsx(Z,{style:{fontSize:l,color:"#d80621"}});case"eur":return S.jsx(fe,{style:{fontSize:l,color:"#003399"}});case"gbp":return S.jsx(de,{style:{fontSize:l,color:"#00247d"}});case"btc":return S.jsx(le,{style:{fontSize:l,color:"#f7931a"}});case"eth":return S.jsx(ue,{style:{fontSize:l,color:"#3c3c3d"}});case"usdt":return S.jsx(ee,{icon:"cryptocurrency:usdt",sx:{fontSize:l,color:"#26a17b",verticalAlign:"middle"}});default:return S.jsx(Z,{style:{fontSize:l,color:"#999"}})}},Ne=({searchText:i,itemsPerPage:l,transactions:d,actions:D})=>{const[x,L]=V.useState(0),T=he(),M=V.useMemo(()=>i?d.filter(c=>c.companyName.toLowerCase().includes(i.toLowerCase())||c.status.toLowerCase().includes(i.toLowerCase())||c._id.toLowerCase().includes(i.toLowerCase())||c.currency&&c.currency.toLowerCase().includes(i.toLowerCase())):d,[i,d]),C=[{field:"amount",headerName:"Amount",flex:1,renderCell:c=>S.jsxs(U,{sx:{display:"flex",alignItems:"center",gap:.5},children:[Se(c.row.currency,T.typography.body2.fontSize),S.jsx(U,{component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem",md:"1rem"}},children:c.value})]}),headerClassName:"responsive-header",cellClassName:"responsive-cell"},{field:"companyName",headerName:"Company",flex:1,headerClassName:"responsive-header",cellClassName:"responsive-cell"},{field:"createdAt",headerName:"Date",flex:1,renderCell:c=>ye(c.value).format("MMM DD, YYYY"),headerClassName:"responsive-header",cellClassName:"responsive-cell"},{field:"status",headerName:"Status",flex:1,renderCell:c=>{const w=c.value,A={pending:{backgroundColor:"#fff9c4",color:"#856404"},processing:{backgroundColor:"#c8e6c9",color:"#2e7d32"},approved:{backgroundColor:"#388e3c",color:"#ffffff"},canceled:{backgroundColor:"#ffcdd2",color:"#c62828"},failed:{backgroundColor:"#d32f2f",color:"#ffffff"},successful:{backgroundColor:"#388e3c",color:"#ffffff"}}[w]||{backgroundColor:"#e0e0e0",color:"#000000"};return S.jsx(U,{sx:{display:"inline-block",padding:"4px 8px",borderRadius:"12px",backgroundColor:A.backgroundColor,color:A.color,fontWeight:"medium",textTransform:"capitalize",fontSize:{xs:"0.5rem",sm:"0.7rem",md:"0.8rem"}},children:w})},headerClassName:"responsive-header",cellClassName:"responsive-cell"}];return D&&C.push({field:"actions",headerName:"Actions",flex:1,sortable:!1,filterable:!1,renderCell:c=>{const w=c.row,$=typeof D=="function"?D(w):D;return S.jsx(oe,{direction:"row",spacing:1,children:$.map((A,v)=>S.jsx(pe,{title:A.label,children:S.jsx("span",{children:A.icon?S.jsx(ee,{icon:A.icon,sx:{cursor:"pointer",fontSize:{xs:"1rem",sm:"1.25rem",md:"1.5rem"}},onClick:()=>A.onClick(w._id)}):S.jsx(U,{component:"span",sx:{cursor:"pointer",fontWeight:500,fontSize:{xs:"0.75rem",sm:"0.875rem",md:"1rem"}},onClick:()=>A.onClick(w._id),children:A.label})})},v))})},headerClassName:"responsive-header",cellClassName:"responsive-cell"}),S.jsx(ie,{autoHeight:!0,pageSize:l,rowsPerPageOptions:[l],rows:M,columns:C,getRowId:c=>c._id,onPageChange:c=>L(c),page:x,components:{Footer:ce},sx:{"& .css-1epsd68-MuiDataGrid-columnHeaderTitle ":{fontSize:{xs:"0.65rem",sm:"0.75rem",md:"1rem"},fontWeight:"bold"},"& .responsive-cell":{fontSize:{xs:"0.6rem",sm:"0.75rem",md:"1rem"}}}})};export{Ne as T,ye as d,we as u};
