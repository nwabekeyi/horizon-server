import{r as n,i as E,j as r,P as R,S as k,B as i,I as w,E as A}from"./index-C-veA1Rv.js";import{u as B}from"./useApi-hqwvaQFr.js";import{C as T,a as W}from"./modal-Cq9y4NFa.js";import{F as D}from"./index-ClSCEk6E.js";import{B as l}from"./Button-BUtGUVw6.js";import{L as d}from"./Link-Dkvr2300.js";import{T as s}from"./Typography-DNw0gmHs.js";import{T as f}from"./TextField-CH6IKT9T.js";import{I as F}from"./InputAdornment-BVYIlHg7.js";import{I as L}from"./Grow-DEkHVcDO.js";import"./useTheme-CSbpYfTu.js";import"./ButtonBase-DHTngUyU.js";import"./useIsFocusVisible-SVz0b4Hl.js";const X=()=>{const[e,x]=n.useState({newPassword:"",confirmPassword:""}),[a,P]=n.useState(!1),[c,t]=n.useState(null),[y,m]=n.useState(!1),g=E(),{error:u,loading:j,callApi:b}=B(),p=new URLSearchParams(g.search).get("token")||"",h=o=>{x({...e,[o.target.name]:o.target.value}),t(null)},v=async o=>{if(o.preventDefault(),e.newPassword!==e.confirmPassword){t("Passwords do not match");return}if(e.newPassword.length<8){t("Password must be at least 8 characters");return}if(!p){t("Invalid or missing token");return}const C={token:p,newPassword:e.newPassword};try{await b({url:A.RESETPASSWORD,method:"PATCH",body:C}),m(!0)}catch(I){console.error("API Error:",I),t("Failed to reset password. Please try again.")}},S=()=>{m(!1)};return j?r.jsx(R,{}):r.jsxs(k,{mx:"auto",width:410,height:"auto",minHeight:800,direction:"column",alignItems:"center",justifyContent:"space-between",children:[r.jsx(i,{width:1,children:r.jsx(l,{variant:"text",component:d,href:"c",sx:{ml:-1.75,pl:1,pr:2},startIcon:r.jsx(w,{icon:"ic:round-keyboard-arrow-left",sx:o=>({fontSize:`${o.typography.h3.fontSize} !important`})}),children:"Back to home"})}),r.jsxs(i,{width:1,children:[r.jsx(s,{variant:"h3",children:"Password Reset"}),r.jsx(s,{mt:1.5,variant:"body2",color:"text.disabled",children:"Enter your new password to reset your password!"}),r.jsxs(i,{component:"form",onSubmit:v,children:[r.jsx(f,{id:"newPassword",name:"newPassword",label:"New Password",type:a?"text":"password",value:e.newPassword,onChange:h,variant:"filled",placeholder:"Min. 8 characters",autoComplete:"new-password",sx:{mt:3},fullWidth:!0,required:!0,InputProps:{endAdornment:r.jsx(F,{position:"end",sx:{opacity:e.newPassword?1:0,pointerEvents:e.newPassword?"auto":"none"},children:r.jsx(L,{"aria-label":"toggle password visibility",onClick:()=>P(!a),sx:{border:"none",bgcolor:"transparent !important"},edge:"end",children:r.jsx(w,{icon:a?"ic:outline-visibility":"ic:outline-visibility-off",color:"neutral.main"})})})}}),r.jsx(f,{id:"confirmPassword",name:"confirmPassword",label:"Confirm Password",type:a?"text":"password",value:e.confirmPassword,onChange:h,variant:"filled",placeholder:"Confirm your new password",sx:{mt:6},fullWidth:!0,required:!0}),c&&r.jsx(s,{color:"error",variant:"body2",mt:2,children:c}),u&&r.jsx(s,{color:"error",variant:"body2",mt:2,children:u.message}),r.jsx(l,{type:"submit",variant:"contained",size:"large",sx:{mt:3},fullWidth:!0,children:"Reset Password"})]}),r.jsxs(s,{mt:3,variant:"body2",textAlign:{xs:"center",md:"left"},letterSpacing:.25,children:["Remember your password?"," ",r.jsx(d,{href:"/authentication/sign-in",color:"primary.main",fontWeight:600,children:"Sign In"})]}),r.jsx(T,{open:y,title:"Password Reset Successful",onCancel:S,noConfirm:!0,children:r.jsxs(W,{children:[r.jsx(s,{variant:"body1",children:"Your password has been successfully reset! Would you like to log in now?"}),r.jsx(l,{component:d,href:"/authentication/sign-in",variant:"contained",color:"primary",sx:{mt:2},children:"Go to Login"})]})})]}),r.jsx(D,{})]})};export{X as default};
